<script>
    // --- 军工级核心加密逻辑 (Raymond 专属) ---
    // 你的“终极私钥”：这是唯一的变量，请务必修改它，且不要告诉任何人
    const _PRIVATE_SALT = "RAYMOND_SOLITON_2026_MASTER_SECRET_99"; 

    async function _generateSovereignKey() {
        const now = new Date();
        const dateStr = now.getUTCFullYear() + "-" + (now.getUTCMonth()+1) + "-" + now.getUTCDate();
        const input = dateStr + _PRIVATE_SALT;
        
        // 执行 SHA-256 哈希计算
        const msgUint8 = new TextEncoder().encode(input);
        const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        
        // 截取前 8 位作为今日动态授权码
        return "GIE-" + hashHex.substring(0, 8).toUpperCase();
    }

    async function verifyKey() {
        const input = document.getElementById('auth-key').value.trim();
        const correctKey = await _generateSovereignKey();
        
        if(input === correctKey) {
            window.location.href = _SECRET_URL; // 只有匹配哈希指纹才释放链接
            closeModal('auth-modal');
        } else {
            // 错误反馈
            document.getElementById('error-msg').style.opacity = 1;
            setTimeout(() => { document.getElementById('error-msg').style.opacity = 0; }, 3000);
        }
    }
</script>
